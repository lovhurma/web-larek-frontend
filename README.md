# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Данные и типы данных испоьзуемые в приложении 

Карточка Продукта

```

export interface IProduct {
  id: string;
  description?: string;
  image: string;
  title: string;
  category: string;
  price: number | null
    selected: boolean;
}
```

Данные о покупателе

```

export interface IForm {
  payment: string;
  address: string;
  email: string;
  phone: string;
}
```

Модель для хранения данных карточек продуктов

```

export interface IProductData {
  total: number
  items: IProduct[]
}
```
Данные о покупателе

```
export interface IOrderData {
  payment: string;
  email: string;
  phone: string;
  address: string;
}
```

Сумма заказа и список ID купленных товаров.

```

 export interface IOrder extends IOrderData {
  totalamount: number
  items: IProduct['id'][]
}
```
## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP: 
- слой представления, отвечает за отображение данных на странице, 
- слой данных, отвечает за хранение и изменение данных
- презентер, отвечает за связь представления и данных.

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы: 
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие   

### Слой данных

#### Класс ProductModal
Класс отвечает за хранение и логику работы с данными.\
В полях класса хранятся следующие данные:
- items: IProduct[] - Массив объектов со всеми товарами
- basket: IProduct[] = [] - корзина с товарами, начальное состояние - пустой массив
- order: IOrder - Информация о заказе при покупке товара

Так же класс предоставляет набор методов для взаимодействия с этими данными.
- addproducts(): IProduct[] - Добавление массива карточек
- getBasketAmount() - Метод для получения количества товаров в корзине
- addToBasket(): -  Добавление товара(карточки) в корзину
- removeFromBasket(): - Удаление товара с корзины
- clearBasket(): - Метод для полной очистки корзины
- getBasketPrice(): - Общая сумма(стоимость) товаров в корзине
- setItems(): - Метод для получения списка ID товаров в корзине 
- addOrderField(field: IOrderData, value: string): - Метод для заполнения полей email, phone, address, payment 
- validateContacts(): - Валидация форм для окошка "контакты"
- validateOrder(): - Валидация форм для окошка "заказ"
- cleanOrder(): - Очистка корзины после покупки товаров
- resetSelected(): - Метод для обновления поля selected во всех товарах после совершения покупки
